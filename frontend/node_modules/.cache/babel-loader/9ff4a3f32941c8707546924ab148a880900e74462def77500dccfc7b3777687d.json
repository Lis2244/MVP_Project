{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Swiper,SwiperSlide}from'swiper/react';// Импортируем Swiper\nimport{Navigation,Pagination}from'swiper/modules';// Импортируем модули Swiper\nimport'swiper/css';// Базовые стили Swiper\nimport'swiper/css/navigation';// Стили для навигации\nimport'swiper/css/pagination';// Стили для пагинации\nimport api from'../services/api';import CreateAnnouncement from'./CreateAnnouncement';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Announcements(){const[announcements,setAnnouncements]=useState([]);const[search,setSearch]=useState('');const[message,setMessage]=useState('');const[showCreateForm,setShowCreateForm]=useState(false);const[selectedAnnouncement,setSelectedAnnouncement]=useState(null);// Состояние для выбранного объявления\n// Функция для получения списка объявлений\nconst fetchAnnouncements=async()=>{try{const response=await api.get(`/announcements?search=${search}`);setAnnouncements(response.data);}catch(error){console.error(error);}};// Загрузка объявлений при изменении поискового запроса\nuseEffect(()=>{fetchAnnouncements();},[search]);// Обработчик клика по объявлению\nconst handleAnnouncementClick=announcement=>{setSelectedAnnouncement(announcement);};// Закрытие модального окна\nconst handleCloseModal=()=>{setSelectedAnnouncement(null);};// Обработчик создания нового объявления\nconst handleNewAnnouncement=newAnnouncement=>{setAnnouncements([newAnnouncement,...announcements]);setShowCreateForm(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-6 text-center\",children:\"\\u041E\\u0431\\u044A\\u044F\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F\"}),localStorage.getItem('token')&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreateForm(!showCreateForm),className:\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded\",children:showCreateForm?'Скрыть форму':'Добавить объявление'})}),showCreateForm&&/*#__PURE__*/_jsx(CreateAnnouncement,{onCreated:handleNewAnnouncement}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u041F\\u043E\\u0438\\u0441\\u043A \\u043F\\u043E \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u044E\",value:search,onChange:e=>setSearch(e.target.value),className:\"w-full border rounded px-4 py-2 focus:outline-none focus:ring focus:border-blue-300\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6\",children:announcements.map(item=>{let imageUrl;try{imageUrl=`http://localhost:5000${JSON.parse(item.image_url)[0]}`;}catch(error){console.error('Ошибка при парсинге image_url:',item.image_url,error);imageUrl='';// Используем пустую строку, если что-то пошло не так\n}return/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleAnnouncementClick(item)// Обработчик клика по объявлению\n,className:\"bg-white rounded-lg shadow p-4 cursor-pointer hover:shadow-lg transition-shadow\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800 mb-2\",children:item.title}),imageUrl&&/*#__PURE__*/_jsx(\"img\",{src:imageUrl,alt:item.title,className:\"w-full h-40 object-cover rounded mb-2\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"\\u041E\\u0442: \",item.email]})]},item.id);})}),selectedAnnouncement&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg w-full max-w-2xl p-6 overflow-y-auto max-h-screen\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4\",children:selectedAnnouncement.title}),/*#__PURE__*/_jsx(Swiper,{modules:[Navigation,Pagination]// Подключаем модули\n,navigation:true// Включаем навигацию (стрелки)\n,pagination:{clickable:true}// Включаем пагинацию (точки)\n,spaceBetween:50// Расстояние между слайдами\n,slidesPerView:1// Количество слайдов на экране\n,children:JSON.parse(selectedAnnouncement.image_url).map((image,index)=>/*#__PURE__*/_jsx(SwiperSlide,{children:/*#__PURE__*/_jsx(\"img\",{src:`http://localhost:5000${image}`,alt:`Изображение ${index+1}`,className:\"w-full h-64 object-cover rounded\"})},index))}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435:\"}),\" \",selectedAnnouncement.description]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438:\"}),\" \",selectedAnnouncement.categories]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0426\\u0435\\u043B\\u0435\\u0432\\u0430\\u044F \\u0430\\u0443\\u0434\\u0438\\u0442\\u043E\\u0440\\u0438\\u044F:\"}),\" \",selectedAnnouncement.target_info]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCloseModal,className:\"mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\",children:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"})]})}),message&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-center text-red-500\",children:message})]})});}export default Announcements;","map":{"version":3,"names":["React","useState","useEffect","Swiper","SwiperSlide","Navigation","Pagination","api","CreateAnnouncement","jsx","_jsx","jsxs","_jsxs","Announcements","announcements","setAnnouncements","search","setSearch","message","setMessage","showCreateForm","setShowCreateForm","selectedAnnouncement","setSelectedAnnouncement","fetchAnnouncements","response","get","data","error","console","handleAnnouncementClick","announcement","handleCloseModal","handleNewAnnouncement","newAnnouncement","className","children","localStorage","getItem","onClick","onCreated","type","placeholder","value","onChange","e","target","map","item","imageUrl","JSON","parse","image_url","title","src","alt","email","id","modules","navigation","pagination","clickable","spaceBetween","slidesPerView","image","index","description","categories","target_info"],"sources":["D:/Шаблоны/MVP_Project/frontend/src/components/Announcements.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Swiper, SwiperSlide } from 'swiper/react'; // Импортируем Swiper\r\nimport { Navigation, Pagination } from 'swiper/modules'; // Импортируем модули Swiper\r\nimport 'swiper/css'; // Базовые стили Swiper\r\nimport 'swiper/css/navigation'; // Стили для навигации\r\nimport 'swiper/css/pagination'; // Стили для пагинации\r\nimport api from '../services/api';\r\nimport CreateAnnouncement from './CreateAnnouncement';\r\n\r\nfunction Announcements() {\r\n  const [announcements, setAnnouncements] = useState([]);\r\n  const [search, setSearch] = useState('');\r\n  const [message, setMessage] = useState('');\r\n  const [showCreateForm, setShowCreateForm] = useState(false);\r\n  const [selectedAnnouncement, setSelectedAnnouncement] = useState(null); // Состояние для выбранного объявления\r\n\r\n  // Функция для получения списка объявлений\r\n  const fetchAnnouncements = async () => {\r\n    try {\r\n      const response = await api.get(`/announcements?search=${search}`);\r\n      setAnnouncements(response.data);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  // Загрузка объявлений при изменении поискового запроса\r\n  useEffect(() => {\r\n    fetchAnnouncements();\r\n  }, [search]);\r\n\r\n  // Обработчик клика по объявлению\r\n  const handleAnnouncementClick = (announcement) => {\r\n    setSelectedAnnouncement(announcement);\r\n  };\r\n\r\n  // Закрытие модального окна\r\n  const handleCloseModal = () => {\r\n    setSelectedAnnouncement(null);\r\n  };\r\n\r\n  // Обработчик создания нового объявления\r\n  const handleNewAnnouncement = (newAnnouncement) => {\r\n    setAnnouncements([newAnnouncement, ...announcements]);\r\n    setShowCreateForm(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 p-6\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <h2 className=\"text-3xl font-bold text-gray-800 mb-6 text-center\">Объявления</h2>\r\n        \r\n        {/* Кнопка для показа/скрытия формы создания объявления */}\r\n        {localStorage.getItem('token') && (\r\n          <div className=\"mb-6\">\r\n            <button\r\n              onClick={() => setShowCreateForm(!showCreateForm)}\r\n              className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded\"\r\n            >\r\n              {showCreateForm ? 'Скрыть форму' : 'Добавить объявление'}\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Форма создания объявления */}\r\n        {showCreateForm && (\r\n          <CreateAnnouncement onCreated={handleNewAnnouncement} />\r\n        )}\r\n\r\n        {/* Поиск по объявлениям */}\r\n        <div className=\"mb-6\">\r\n          <input \r\n            type=\"text\"\r\n            placeholder=\"Поиск по названию\"\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n            className=\"w-full border rounded px-4 py-2 focus:outline-none focus:ring focus:border-blue-300\"\r\n          />\r\n        </div>\r\n\r\n        {/* Список объявлений */}\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6\">\r\n          {announcements.map(item => {\r\n            let imageUrl;\r\n            try {\r\n              imageUrl = `http://localhost:5000${JSON.parse(item.image_url)[0]}`;\r\n            } catch (error) {\r\n              console.error('Ошибка при парсинге image_url:', item.image_url, error);\r\n              imageUrl = ''; // Используем пустую строку, если что-то пошло не так\r\n            }\r\n\r\n            return (\r\n              <div\r\n                key={item.id}\r\n                onClick={() => handleAnnouncementClick(item)} // Обработчик клика по объявлению\r\n                className=\"bg-white rounded-lg shadow p-4 cursor-pointer hover:shadow-lg transition-shadow\"\r\n              >\r\n                <h3 className=\"text-xl font-semibold text-gray-800 mb-2\">{item.title}</h3>\r\n                {imageUrl && (\r\n                  <img src={imageUrl} alt={item.title} className=\"w-full h-40 object-cover rounded mb-2\" />\r\n                )}\r\n                <p className=\"text-sm text-gray-600\">От: {item.email}</p>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Модальное окно с деталями объявления */}\r\n        {selectedAnnouncement && (\r\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n            <div className=\"bg-white rounded-lg shadow-lg w-full max-w-2xl p-6 overflow-y-auto max-h-screen\">\r\n              <h2 className=\"text-2xl font-bold mb-4\">{selectedAnnouncement.title}</h2>\r\n\r\n              {/* Слайдер для изображений */}\r\n              <Swiper\r\n                modules={[Navigation, Pagination]} // Подключаем модули\r\n                navigation // Включаем навигацию (стрелки)\r\n                pagination={{ clickable: true }} // Включаем пагинацию (точки)\r\n                spaceBetween={50} // Расстояние между слайдами\r\n                slidesPerView={1} // Количество слайдов на экране\r\n              >\r\n                {JSON.parse(selectedAnnouncement.image_url).map((image, index) => (\r\n                  <SwiperSlide key={index}>\r\n                    <img\r\n                      src={`http://localhost:5000${image}`}\r\n                      alt={`Изображение ${index + 1}`}\r\n                      className=\"w-full h-64 object-cover rounded\"\r\n                    />\r\n                  </SwiperSlide>\r\n                ))}\r\n              </Swiper>\r\n\r\n              {/* Детали объявления */}\r\n              <p className=\"mt-4\"><strong>Описание:</strong> {selectedAnnouncement.description}</p>\r\n              <p className=\"mt-2\"><strong>Категории:</strong> {selectedAnnouncement.categories}</p>\r\n              <p className=\"mt-2\"><strong>Целевая аудитория:</strong> {selectedAnnouncement.target_info}</p>\r\n\r\n              {/* Кнопка закрытия */}\r\n              <button\r\n                onClick={handleCloseModal}\r\n                className=\"mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\r\n              >\r\n                Закрыть\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Сообщения об ошибках */}\r\n        {message && <p className=\"mt-4 text-center text-red-500\">{message}</p>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Announcements;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}