{"ast":null,"code":"import React,{useState,useEffect}from'react';import api from'../services/api';import CreateAnnouncement from'./CreateAnnouncement';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Announcements(){const[announcements,setAnnouncements]=useState([]);const[search,setSearch]=useState('');const[message,setMessage]=useState('');const[showCreateForm,setShowCreateForm]=useState(false);const fetchAnnouncements=async()=>{try{const response=await api.get(`/announcements?search=${search}`);setAnnouncements(response.data);}catch(error){console.error(error);}};useEffect(()=>{fetchAnnouncements();},[search]);const handleNewAnnouncement=newAnnouncement=>{// Можно добавить новое объявление в начало списка\nsetAnnouncements([newAnnouncement,...announcements]);// Скрыть форму после успешного создания\nsetShowCreateForm(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-6 text-center\",children:\"\\u041E\\u0431\\u044A\\u044F\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F\"}),localStorage.getItem('token')&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreateForm(!showCreateForm),className:\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded\",children:showCreateForm?'Скрыть форму':'Добавить объявление'})}),showCreateForm&&/*#__PURE__*/_jsx(CreateAnnouncement,{onCreated:handleNewAnnouncement}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u041F\\u043E\\u0438\\u0441\\u043A \\u043F\\u043E \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u044E\",value:search,onChange:e=>setSearch(e.target.value),className:\"w-full border rounded px-4 py-2 focus:outline-none focus:ring focus:border-blue-300\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6\",children:announcements.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800 mb-2\",children:item.title}),/*#__PURE__*/_jsx(\"img\",{src:JSON.parse(item.image_url)[0],alt:item.title,className:\"w-full h-40 object-cover rounded mb-2\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"\\u041E\\u0442: \",item.email]})]},item.id))}),message&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-center text-red-500\",children:message})]})});}export default Announcements;","map":{"version":3,"names":["React","useState","useEffect","api","CreateAnnouncement","jsx","_jsx","jsxs","_jsxs","Announcements","announcements","setAnnouncements","search","setSearch","message","setMessage","showCreateForm","setShowCreateForm","fetchAnnouncements","response","get","data","error","console","handleNewAnnouncement","newAnnouncement","className","children","localStorage","getItem","onClick","onCreated","type","placeholder","value","onChange","e","target","map","item","title","src","JSON","parse","image_url","alt","email","id"],"sources":["C:/Users/Acer/Desktop/Шаблоны/MVP_Project/frontend/src/components/Announcements.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport api from '../services/api';\r\nimport CreateAnnouncement from './CreateAnnouncement';\r\n\r\nfunction Announcements() {\r\n  const [announcements, setAnnouncements] = useState([]);\r\n  const [search, setSearch] = useState('');\r\n  const [message, setMessage] = useState('');\r\n  const [showCreateForm, setShowCreateForm] = useState(false);\r\n\r\n  const fetchAnnouncements = async () => {\r\n    try {\r\n      const response = await api.get(`/announcements?search=${search}`);\r\n      setAnnouncements(response.data);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchAnnouncements();\r\n  }, [search]);\r\n\r\n  const handleNewAnnouncement = (newAnnouncement) => {\r\n    // Можно добавить новое объявление в начало списка\r\n    setAnnouncements([newAnnouncement, ...announcements]);\r\n    // Скрыть форму после успешного создания\r\n    setShowCreateForm(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 p-6\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <h2 className=\"text-3xl font-bold text-gray-800 mb-6 text-center\">Объявления</h2>\r\n        \r\n        {/* Кнопка для показа/скрытия формы создания объявления (показываем только если пользователь авторизован) */}\r\n        {localStorage.getItem('token') && (\r\n          <div className=\"mb-6\">\r\n            <button\r\n              onClick={() => setShowCreateForm(!showCreateForm)}\r\n              className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded\"\r\n            >\r\n              {showCreateForm ? 'Скрыть форму' : 'Добавить объявление'}\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Форма создания объявления */}\r\n        {showCreateForm && (\r\n          <CreateAnnouncement onCreated={handleNewAnnouncement} />\r\n        )}\r\n\r\n        <div className=\"mb-6\">\r\n          <input \r\n            type=\"text\"\r\n            placeholder=\"Поиск по названию\"\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n            className=\"w-full border rounded px-4 py-2 focus:outline-none focus:ring focus:border-blue-300\"\r\n          />\r\n        </div>\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6\">\r\n          {announcements.map(item => (\r\n            <div key={item.id} className=\"bg-white rounded-lg shadow p-4\">\r\n              <h3 className=\"text-xl font-semibold text-gray-800 mb-2\">{item.title}</h3>\r\n              {/* Обратите внимание: здесь используется JSON.parse(item.image_url)[0] */}\r\n              <img src={JSON.parse(item.image_url)[0]} alt={item.title} className=\"w-full h-40 object-cover rounded mb-2\" />\r\n              <p className=\"text-sm text-gray-600\">От: {item.email}</p>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        {message && <p className=\"mt-4 text-center text-red-500\">{message}</p>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Announcements;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}