{"ast":null,"code":"import React,{useState,useEffect}from'react';import api from'../services/api';import{Swiper,SwiperSlide}from'swiper/react';import{Navigation,Pagination}from'swiper/modules';import'swiper/css';import'swiper/css/navigation';import'swiper/css/pagination';import EditAnnouncementModal from'./EditAnnouncementModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function MyAnnouncements(){const[announcements,setAnnouncements]=useState([]);const[selectedAnnouncement,setSelectedAnnouncement]=useState(null);const[isEditing,setIsEditing]=useState(false);useEffect(()=>{fetchMyAnnouncements();},[]);const fetchMyAnnouncements=async()=>{try{const token=localStorage.getItem('token');const response=await api.get('/announcements/my',{headers:{Authorization:`Bearer ${token}`}});setAnnouncements(response.data);}catch(error){console.error('Ошибка при получении объявлений:',error);}};const handleEdit=announcement=>{setSelectedAnnouncement(announcement);setIsEditing(true);};const handleDelete=async id=>{try{await api.delete(`/announcements/${id}`);fetchMyAnnouncements();}catch(error){console.error(error);}};const handleSave=async updatedAnnouncement=>{try{await api.put(`/announcements/${updatedAnnouncement.id}`,updatedAnnouncement);fetchMyAnnouncements();setIsEditing(false);}catch(error){console.error(error);}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-6 text-center\",children:\"\\u041C\\u043E\\u0438 \\u043E\\u0431\\u044A\\u044F\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6\",children:announcements.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800 mb-2\",children:item.title}),item.image_url&&/*#__PURE__*/_jsx(Swiper,{modules:[Navigation,Pagination],navigation:true,pagination:{clickable:true},spaceBetween:50,slidesPerView:1,children:JSON.parse(item.image_url).map((image,index)=>/*#__PURE__*/_jsx(SwiperSlide,{children:/*#__PURE__*/_jsx(\"img\",{src:`http://localhost:5000${image}`,alt:`Изображение ${index+1}`,className:\"w-full h-64 object-cover rounded\"})},index))}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:item.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEdit(item),className:\"bg-blue-500 text-white px-4 py-2 rounded\",children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(item.id),className:\"bg-red-500 text-white px-4 py-2 rounded\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]},item.id))}),isEditing&&/*#__PURE__*/_jsx(EditAnnouncementModal,{announcement:selectedAnnouncement,onClose:()=>setIsEditing(false),onSave:handleSave})]})});}export default MyAnnouncements;","map":{"version":3,"names":["React","useState","useEffect","api","Swiper","SwiperSlide","Navigation","Pagination","EditAnnouncementModal","jsx","_jsx","jsxs","_jsxs","MyAnnouncements","announcements","setAnnouncements","selectedAnnouncement","setSelectedAnnouncement","isEditing","setIsEditing","fetchMyAnnouncements","token","localStorage","getItem","response","get","headers","Authorization","data","error","console","handleEdit","announcement","handleDelete","id","delete","handleSave","updatedAnnouncement","put","className","children","map","item","title","image_url","modules","navigation","pagination","clickable","spaceBetween","slidesPerView","JSON","parse","image","index","src","alt","description","onClick","onClose","onSave"],"sources":["D:/Шаблоны/MVP_Project/frontend/src/components/MyAnnouncements.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport api from '../services/api';\r\nimport { Swiper, SwiperSlide } from 'swiper/react';\r\nimport { Navigation, Pagination } from 'swiper/modules';\r\nimport 'swiper/css';\r\nimport 'swiper/css/navigation';\r\nimport 'swiper/css/pagination';\r\nimport EditAnnouncementModal from './EditAnnouncementModal';\r\n\r\nfunction MyAnnouncements() {\r\n  const [announcements, setAnnouncements] = useState([]);\r\n  const [selectedAnnouncement, setSelectedAnnouncement] = useState(null);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchMyAnnouncements();\r\n  }, []);\r\n\r\n  const fetchMyAnnouncements = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const response = await api.get('/announcements/my', {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      setAnnouncements(response.data);\r\n    } catch (error) {\r\n      console.error('Ошибка при получении объявлений:', error);\r\n    }\r\n  };\r\n\r\n  const handleEdit = (announcement) => {\r\n    setSelectedAnnouncement(announcement);\r\n    setIsEditing(true);\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      await api.delete(`/announcements/${id}`);\r\n      fetchMyAnnouncements();\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const handleSave = async (updatedAnnouncement) => {\r\n    try {\r\n      await api.put(`/announcements/${updatedAnnouncement.id}`, updatedAnnouncement);\r\n      fetchMyAnnouncements();\r\n      setIsEditing(false);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 p-6\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <h2 className=\"text-3xl font-bold text-gray-800 mb-6 text-center\">Мои объявления</h2>\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6\">\r\n          {announcements.map(item => (\r\n            <div key={item.id} className=\"bg-white rounded-lg shadow p-4\">\r\n              <h3 className=\"text-xl font-semibold text-gray-800 mb-2\">{item.title}</h3>\r\n              {item.image_url && (\r\n                <Swiper\r\n                  modules={[Navigation, Pagination]}\r\n                  navigation\r\n                  pagination={{ clickable: true }}\r\n                  spaceBetween={50}\r\n                  slidesPerView={1}\r\n                >\r\n                  {JSON.parse(item.image_url).map((image, index) => (\r\n                    <SwiperSlide key={index}>\r\n                      <img\r\n                        src={`http://localhost:5000${image}`}\r\n                        alt={`Изображение ${index + 1}`}\r\n                        className=\"w-full h-64 object-cover rounded\"\r\n                      />\r\n                    </SwiperSlide>\r\n                  ))}\r\n                </Swiper>\r\n              )}\r\n              <p className=\"text-sm text-gray-600\">{item.description}</p>\r\n              <div className=\"mt-4 flex space-x-2\">\r\n                <button\r\n                  onClick={() => handleEdit(item)}\r\n                  className=\"bg-blue-500 text-white px-4 py-2 rounded\"\r\n                >\r\n                  Редактировать\r\n                </button>\r\n                <button\r\n                  onClick={() => handleDelete(item.id)}\r\n                  className=\"bg-red-500 text-white px-4 py-2 rounded\"\r\n                >\r\n                  Удалить\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        {isEditing && (\r\n          <EditAnnouncementModal\r\n            announcement={selectedAnnouncement}\r\n            onClose={() => setIsEditing(false)}\r\n            onSave={handleSave}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MyAnnouncements;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,GAAG,KAAM,iBAAiB,CACjC,OAASC,MAAM,CAAEC,WAAW,KAAQ,cAAc,CAClD,OAASC,UAAU,CAAEC,UAAU,KAAQ,gBAAgB,CACvD,MAAO,YAAY,CACnB,MAAO,uBAAuB,CAC9B,MAAO,uBAAuB,CAC9B,MAAO,CAAAC,qBAAqB,KAAM,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5D,QAAS,CAAAC,eAAeA,CAAA,CAAG,CACzB,KAAM,CAACC,aAAa,CAAEC,gBAAgB,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAACe,oBAAoB,CAAEC,uBAAuB,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CACtE,KAAM,CAACiB,SAAS,CAAEC,YAAY,CAAC,CAAGlB,QAAQ,CAAC,KAAK,CAAC,CAEjDC,SAAS,CAAC,IAAM,CACdkB,oBAAoB,CAAC,CAAC,CACxB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAA,oBAAoB,CAAG,KAAAA,CAAA,GAAY,CACvC,GAAI,CACF,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAArB,GAAG,CAACsB,GAAG,CAAC,mBAAmB,CAAE,CAClDC,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUN,KAAK,EAChC,CACF,CAAC,CAAC,CACFN,gBAAgB,CAACS,QAAQ,CAACI,IAAI,CAAC,CACjC,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,CAAEA,KAAK,CAAC,CAC1D,CACF,CAAC,CAED,KAAM,CAAAE,UAAU,CAAIC,YAAY,EAAK,CACnCf,uBAAuB,CAACe,YAAY,CAAC,CACrCb,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAED,KAAM,CAAAc,YAAY,CAAG,KAAO,CAAAC,EAAE,EAAK,CACjC,GAAI,CACF,KAAM,CAAA/B,GAAG,CAACgC,MAAM,CAAC,kBAAkBD,EAAE,EAAE,CAAC,CACxCd,oBAAoB,CAAC,CAAC,CACxB,CAAE,MAAOS,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAAO,UAAU,CAAG,KAAO,CAAAC,mBAAmB,EAAK,CAChD,GAAI,CACF,KAAM,CAAAlC,GAAG,CAACmC,GAAG,CAAC,kBAAkBD,mBAAmB,CAACH,EAAE,EAAE,CAAEG,mBAAmB,CAAC,CAC9EjB,oBAAoB,CAAC,CAAC,CACtBD,YAAY,CAAC,KAAK,CAAC,CACrB,CAAE,MAAOU,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC,CACtB,CACF,CAAC,CAED,mBACEnB,IAAA,QAAK6B,SAAS,CAAC,6BAA6B,CAAAC,QAAA,cAC1C5B,KAAA,QAAK2B,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChC9B,IAAA,OAAI6B,SAAS,CAAC,mDAAmD,CAAAC,QAAA,CAAC,iFAAc,CAAI,CAAC,cACrF9B,IAAA,QAAK6B,SAAS,CAAC,sDAAsD,CAAAC,QAAA,CAClE1B,aAAa,CAAC2B,GAAG,CAACC,IAAI,eACrB9B,KAAA,QAAmB2B,SAAS,CAAC,gCAAgC,CAAAC,QAAA,eAC3D9B,IAAA,OAAI6B,SAAS,CAAC,0CAA0C,CAAAC,QAAA,CAAEE,IAAI,CAACC,KAAK,CAAK,CAAC,CACzED,IAAI,CAACE,SAAS,eACblC,IAAA,CAACN,MAAM,EACLyC,OAAO,CAAE,CAACvC,UAAU,CAAEC,UAAU,CAAE,CAClCuC,UAAU,MACVC,UAAU,CAAE,CAAEC,SAAS,CAAE,IAAK,CAAE,CAChCC,YAAY,CAAE,EAAG,CACjBC,aAAa,CAAE,CAAE,CAAAV,QAAA,CAEhBW,IAAI,CAACC,KAAK,CAACV,IAAI,CAACE,SAAS,CAAC,CAACH,GAAG,CAAC,CAACY,KAAK,CAAEC,KAAK,gBAC3C5C,IAAA,CAACL,WAAW,EAAAmC,QAAA,cACV9B,IAAA,QACE6C,GAAG,CAAE,wBAAwBF,KAAK,EAAG,CACrCG,GAAG,CAAE,eAAeF,KAAK,CAAG,CAAC,EAAG,CAChCf,SAAS,CAAC,kCAAkC,CAC7C,CAAC,EALce,KAML,CACd,CAAC,CACI,CACT,cACD5C,IAAA,MAAG6B,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAEE,IAAI,CAACe,WAAW,CAAI,CAAC,cAC3D7C,KAAA,QAAK2B,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAClC9B,IAAA,WACEgD,OAAO,CAAEA,CAAA,GAAM3B,UAAU,CAACW,IAAI,CAAE,CAChCH,SAAS,CAAC,0CAA0C,CAAAC,QAAA,CACrD,gFAED,CAAQ,CAAC,cACT9B,IAAA,WACEgD,OAAO,CAAEA,CAAA,GAAMzB,YAAY,CAACS,IAAI,CAACR,EAAE,CAAE,CACrCK,SAAS,CAAC,yCAAyC,CAAAC,QAAA,CACpD,4CAED,CAAQ,CAAC,EACN,CAAC,GAnCEE,IAAI,CAACR,EAoCV,CACN,CAAC,CACC,CAAC,CACLhB,SAAS,eACRR,IAAA,CAACF,qBAAqB,EACpBwB,YAAY,CAAEhB,oBAAqB,CACnC2C,OAAO,CAAEA,CAAA,GAAMxC,YAAY,CAAC,KAAK,CAAE,CACnCyC,MAAM,CAAExB,UAAW,CACpB,CACF,EACE,CAAC,CACH,CAAC,CAEV,CAEA,cAAe,CAAAvB,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}